06/19
패키지 - 모듈의 모음

$npm init
프로젝트 디렉터리를 생성하고, 해당 디렉터리 안에서 npm init 명령어를 사용하면 몇 번의 질문을 통해 package.json이라는 파일을 만들어 주고 이 디렉터리는 Node.js 프로젝트가 됨

package.json
프로젝트 관련 정보들이 저장되는 파일이 파일을 직접 수정하거나 npm 명령어를 사용하여 프로젝트 정보를 수정할 수 있음

package.json
version  프로젝트의 버전
name  프로젝트의 이름
description  프로젝트 설명
scripts  npm run [script name]으로 실행할 수 있는사용자 작성 스크립트
dependencies  의존성 패키지들
devDependencies  개발환경에서만 사용하는 의존성 패키지들

$npm install [package-name]
필요한 패키지를 프로젝트에 추가할 수 있음.
추가된 패키지는 package.json의 dependencies 안에 추가되며,node_modules  디렉터리에 저장됨.

$npm install [package-name] --save-dev
npm은 개발용 의존성을 분리하여 관리할 수 있음
개발용 의존성이란 배포 전까지만 사용하는 의존성 (ex. 유닛 테스트 라이브러리) 
--save-dev 옵션을 이용하면 개발용 의존성을 추가할 수 있음
개발용 의존성은 package.json의 devDependencies에 추가됨

$npm install --production
프로젝트를 배포할 때에는 개발용 의존성을 같이 포함할 필요가 없음 
package.json 의 dependencies만 node_modules에 내려받음

$npm install [package-name] --global
패키지를 전역 패키지 디렉터리에 내려받음
주로 프로젝트에 종속되지 않는 커맨드라인 도구들을 전역 패키지로 추가해서 사용 
Ex) express-generator, pm2

$npm remove [package-name]
의존성 패키지를 삭제할 수 있음
package.json의 dependencies와 devDependencies에서 삭제하고 
node_modules에서도 삭제

스크립트 실행하기
스크립트란 간단한 동작을 수행하는 코드 
package.json의 scripts에 선언된 스크립트를 
npm run [script-name] 명령어로 실행할 수 있음


NPM 요약

명령어
npm init  프로젝트 생성
npm install  의존성 추가
npm remove  의존성 삭제
npm run  스크립트 실행

주요 파일/디렉터리
node_modules  프로젝트 의존성 저장 디렉터리
package.json  프로젝트 관리 (버전, 의존성, 스크립트, …)
package-lock.json  의존성 버전 확인

------------------------------------------------------------
npm실습

mkdir 프로젝트명 : 프로젝트명 폴더 만들기
cd 프로젝트명 : 프로젝트명로 이동하기
npm init : 기본 파일생성
cat 파일명 : 파일명 보기
npm install 패키지명 : 패키지명 추가하기
ls 디렉토리명 : 디렉토리 확인하기
npm i : node_modules디렉토리 다시받기
npm i 패키지명 --save-dev : 개발용 의존성으로 패키지 추가하기
package.json 파일안에 scripts 부분 추가하면 script로 실행
"say-hi" :"cowsay \"HI\""
npm run say-hi : npm script 실행
npm remove 패키지명 : 패키지 삭제

사용했던 패키지명 : dayjs, cowsay

------------------------------------------------------------
NPX
npm 패키지를 설치하지 않고 사용할 수 있게 해주는 도구 
프로젝트에 추가하거나 전역 패키지로 추가하지 않고, 
npx를 이용하여 바로 실행할 수 있음

NPX - github gist 코드 실행
$ npx https://gist.github.com/zkat/4bc19503fe9e9309e2bfaa2c58074d32
gist는 github에 등록된 간단한 코드
npx를 이용하면 gist 코드를 다운받지 않고 바로 실행 가능 
git이 설치되어 있어야 함
온라인상의 코드는 어떤 위험이 있을지 모르므로 코드를 잘 확인하고 실행해야 함

모듈이란?
간단한 프로그램이라면 파일 하나로도 가능
프로젝트가 커지면 기능에 맞게 코드를 분리하는 것이 중요 
모듈은 코드를 분리하기 위한 방법

##Node.js의 기본 제공 모듈 - console
브라우저에서 제공되는 console과 유사한 디버깅 도구 
log, warn, error 함수로 로그 레벨 표시
time, timeLog, timeEnd 함수로 시간 추적

##Node.js의 기본 제공 모듈 - process
현재 실행프로세스 관련 기능 제공
arch(알키텍쳐), argv(알규먼트), env 등 실행 환경 및 변수 관련 값 제공 
abort, kill, exit 등 프로세스 동작 관련 함수 제공

##Node.js의 기본 제공 모듈 - fs
파일 입출력을 하기 위해 사용
readFile, writeFile 함수로 파일 읽기, 쓰기 
-Sync 함수 제공. 동기 동작
watch로 파일/디렉터리 변경 이벤트 감지

##Node.js의 기본 제공 모듈 - http
http 서버, 클라이언트를 위해 사용 
createServer 함수로 서버 생성 
Request 함수로 http 요청 생성

##기타 기본제공 모듈
url: url 파싱
os: 운영체제 정보 - cpu, memory, type …
Path: 디렉터리 string 관련 작업 - 서로 다른 운영체제 간 공통된 로직
crypto: 암호화, hash 관련 함수 제공

node.js 문서 api 사이트
https://nodejs.org/dist/latest-v14.x/docs/api/

------------------------------------------------------------
##모듈의 기본적인 작성법
module.exports  = { 
name,
age, 
nationality,
};
모듈이 load될 때 사용될 값을 module.exports로 내보냄.

##함수를 export하는 모듈 작성법
module.exports = (name, age, nationality) => { 
return {
name, 
age, 
nationality,
}; 
}

##모듈의 사용 방법 - require 동작의 이해
require 할 때 모듈 코드가 실행됨
Node.js의 모듈은 첫   require 시에 cache, 두 번 실행하지 않음 
모듈 코드를 여러 번 실행하기 위해선 함수 모듈로 작성

##모듈의 사용 방법 - npm 패키지
const dayjs = require('dayjs'); 
console.log(dayjs());
의존성 패키지들은 require(‘package-name’)로 load 할 수 있음 
패키지를 사용하려면 node_modules에 내려받아져 있어야 함

##모듈의 사용 방법 - 직접 작성한 모듈
const myModule = require('./my-module'); 
console.log(myModule);
직접 작성한 모듈은 현재 파일과의 상대 디렉터리로 load 
my-module이 .js 파일인 경우 해당 파일 load
my-module이 디렉터리인 경우 my-module/index.js 파일 load

##모듈의 사용 방법 - 함수형 모듈
const myFunctionModule = require('./my-function-module'); 
console.log(myFunctionModule(name, age, nationality));
함수형 모듈은 load한 경우 모듈이 바로 실행되지 않음 
필요한 시점에 load된 함수를 실행하여 모듈을 사용할 수 있음

##모듈의 사용 방법 - json 파일
const myData = require('./my-data'); 
console.log(myData);
require로 json 파일도 load 가능 
object로 자동파싱

##ES Module
ES6에서 등장한 JavaScript의 공식적인 표준 모듈 
JavaScript는 기본적으로 ‘모듈’을 제공하고 있지 않았음
Node.js는 독자적인 방식을 통해 모듈을 지원하고 있었음 (commonjs) 
ES Module의 등장으로 Node.js에선 두 가지 모듈을 지원할 필요가 생김

##ES Module과 commonjs
ES Module과 commonjs는 문법과 기본적인 동작 방식이 다름 
commonjs는 module.exports와 require로 모듈을 만들고 사용 
ES Module은export와 import로 모듈을 만들고 사용

------------------------------------------------------------
CSR
Client-Side Rendering
사이트가 변하는 부분들을 프론트엔드에서 처리
프론트 엔드 코드에 페이지 리소스들이 미리 정의되어 있음 
서버와의 통신은 API 통신을 이용
빠른 반응이지만 페이지의 내용은 API 호출이 완료된 후에 보여짐 
복잡한 프로젝트 구성, 큰 개발 사이즈

SSR
Server-Side Rendering
사이트가 변하는 부분들을 백엔드에서 처리
백엔드에서 HTML 파일을 작성해서 프론트엔드로 전달 
CSR에 비해 쉬운 구성, 작은 개발사이즈
로딩이 완료되면 페이지와 데이터가 한 번에 표시됨 
상대적으로 사용자가 보기엔 로딩이 느려 보임
페이지 이동할 때마다 다시 로딩하기 때문에 페이지 깜빡임

##웹 프레임워크 - HTTP 요청 처리
웹 프레임워크는 HTTP 요청을 처리할 수 있음 
어떤 데이터를 필요로 하는지,
어떤 사용자로부터 요청이 수신되었는지 등

##웹 프레임워크 - HTTP 응답 처리
웹 프레임워크는 HTTP 응답을 처리할 수 있음 
응답 데이터가 어떤 형식인지,
응답 상태가 정상적인지 등

##웹 프레임워크 - 라우팅
웹 프레임워크는 HTTP 요청을 분기하는 방법을 제공함 
HTTP 요청 URL에 해당하는 알맞은 응답의 경로를 미리 설정

##웹 프레임워크 - HTML Templating
웹 프레임워크는 SSR을 구현하기 위한 방법을 제공함 
SSR에서 응답으로 보낼 HTML을 서버에서 작성하기 위해, 
HTML Template를 통해 미리 페이지의 뼈대를 작성 가능

Node.js 의 웹 프레임워크
Node.js 에는 다양한 웹 프레임워크가 있음
Express.js - Node.js 의 가장 유명한 웹 프레임워크 (본 강의에서 사용) 
Koa.js - 현대적인 JavaScript를 적극적으로 사용하는 웹 프레임워크 
Nest.js - TypeScript 를 사용하며, 고정된 구조를 제공하는 웹 프레임워크 
기타 - Hapi, Sails.js, Meteor.js 등

------------------------------------------------------------
express 실습
디렉토리 생성 - npm init - 값 설정후 - npm i express 

app 객체 - 주요 기능

##app.use()
middleware 를 사용하기 위한 함수
미들웨어에 대한 자세한 설명은 다음 장에서 학습함

##app.listen()
http 서버를 생성해주는 함수
express-generator 를 사용하면 http.createServer를 사용하는데
app.listen 함수로 대체할 수 있음

##app.locals
app에서 사용할 공통 상수
Express.js 에선 global 변수를 선언하지 않고 이 값을 사용할 수 있음

##req.params
URL 표현 중 /path/:id 에서 
:id 를 req.params.id 로 사용할 수 있음

##req.queries
URL 표현 중 /path?page=2 에서
page 부분을 req.queries.page 로 사용할 수 있음

##req.body
일반적으로 POST 요청의 요청 데이터를 담고 있음 
req.body 에 요청 데이터가 저장되어 들어옴

##req.get('')
HTTP Request 의 헤더 값을 가져올 수 있음 
req.get('Authorization') 등으로 값을 가져옴

##res.send()
text 형식의 HTTP 응답을 전송함

##res.json()
json 형식의 HTTP 응답을 전송함

##res.render()
HTML Template 을 사용하여 화면을 전송함

##res.set()
HTTP 응답의 헤더를 설정함

##res.status()
HTTP 응답의 상태 값을 설정함

